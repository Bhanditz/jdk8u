apply plugin: 'java'

import static java.lang.System.out
import static java.lang.System.err


sourceSets.main.java.srcDirs =
        ["../../jdk/src/share/classes",
         "../../jdk/src/macosx/classes",
         "../../jdk/src/windows/classes",
         "../../jdk/src/solaris/classes"]

def buildDir = project.buildscript.sourceFile.parentFile.parentFile.parentFile
def makeCmd = "make -C " + buildDir + " COMPILER_WARNINGS_FATAL=false"

defaultTasks 'images'

task images << {
    println makeCmd + " images"
    def proc = makeCmd.execute()
    proc.consumeProcessOutput(out, err)
    proc.waitFor()
    assert proc.exitValue() == 0
}

task clean << {
    println makeCmd + " clean"
    def proc = makeCmd.execute()
    proc.consumeProcessOutput(out, err)
    proc.waitFor()
    assert proc.exitValue() == 0
}